- id: 18708a19-4dc3-4cbc-9ba8-49582f186d72
  name: Discover TorchServe API
  description: FILL ME IN
  tactic: discovery
  technique_name: Discover ML Artifacts
  technique_id: AML.T0007 
  executors:
  - platform: linux
    name: sh
    command: |
      chmod +x discover_torchserve_api.sh && ./discover_torchserve_api.sh "#{target.api.binding_address_list}"
    parsers:
    - module: plugins.arsenal.app.parsers.api
    - parserconfigs:
      - source: target.model_server.framework
        target: has_inference_api_endpoint
        edge: target.model_server.inference_api_endpoint # or target.model_server.inference_address ?
    - parserconfigs:
      - source: target.model_server.framework
        target: has_inference_api_endpoint
        edge: target.model_server.models_api_endpoint # or target.model_server.models_address ?
    payloads: [discover_torchserve_api.sh]
    cleanup: [rm discover_torchserve_api.sh]
    timeout: 300
  repeatable: true